<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QNANO: Example: Graphene tight-binding calculation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QNANO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">QNANO Documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example: Graphene tight-binding calculation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="graphene_diagonalization"></a>
Basic tight-binding calculation for monolayer graphene</h1>
<p>Directory: "examples/graphene/02_tightbinding_monolayer_Eigen":</p>
<p>Directory: "examples/graphene/03_tightbinding_monolayer_slepc":</p>
<p>This example shows how to diagonalize small tight-binding problems in the case of graphene. The code supports exact diagonalization using the Eigen library as well as the iterative methods supported by SLEPc. Iterative methods are required when the dimension of the Hamiltonian becomes too large for exact diagonalization routines. One advantage of the exact diagonalization routine is that no installation of SLEPc/PETSc is required.</p>
<p>To run the example go to a new directory and execute: </p><pre class="fragment">$QNANO_DIR/examples/graphene/02_tightbinding_monolayer_Eigen/run_example.sh
</pre><p>The first step in these scripts is the structure generation. This has already been addressed in the previous example. The diagonalization is performed by the command </p><pre class="fragment">echo "Diagonalizing armchair structure ..."
$QNANO_DIR/bin/tightbinding_eigen -resources_dir $QNANO_DIR/resources \
-positions positions_armchair_hex8.dat \
-eigenvalue_filename "energies_armchair_hex8.dat"  -EV_filename_pattern "EV*_armchair_hex8.dat"  -nr_print 2 \
-eps_target 0.000001 -eps_nev 20  -eps_max_it 1000000 -eps_tol 1e-8
</pre><p> The tool "tightbinding_eigen" requires the specification of a "positions" file from the stucture generation process. The materials specified in this file are looked for in the "resources_dir". The default parameter files are provided in "$QNANO_DIR/resources".</p>
<p>The optional parameters "eigenvalue_filename" and "EV_filename_pattern" determine the name of the generated files for eigenvalues and eigenvectors. "nr_print" is the number of eigenstates that are printed (if it is set to -1 all converged states will be printed).</p>
<p>Parameters starting with "eps_" are in general forwarded to SLEPc (cf. documentation of SLEPc). However, to be able to use the same parameters for the exact diagonalization we also use "eps_target" for the targeted eigenvalue (EV0_... will be the eigenstate closest to the target). The SLEPc parameters "eps_nev" for the number of eigenstates to be calculated and "eps_max_it" for the maximal number of iteration used in the iterative method are ignored here but are used in example "03_tightbinding_monolayer_slepc". The same is true for the convergence criterion "eps_tol" (tolerance for convergence of eigenvalue) used for the iterative method.</p>
<p>The generated output has the following form: the eigenvalue file "energies_armchair_hex8.dat" contains one eigenvalue per line: </p><pre class="fragment">0.281264240785
0.281264240785
-0.281264240785
-0.281264240785
0.429409803843
-0.429409803843
0.617728017747
-0.617728017747
0.624044501574
...
</pre><p> (Note: we have used a target value slightly larger than zero to make the positive eigenvalues the first ones to be listed, just for the sake of definiteness) The eigenvector corresponding to the first eigenstate can be found in "EV0_armchair_hex8.dat": </p><pre class="fragment">number_of_atoms 1014
number_of_orbitals 1
0.001278289 0
-0.01792051 0
0.000521853 0
0.00286991 0
-0.029912409 0
0.000134836 0
0.017792104 0
-0.003200369 0
...
</pre><p> where after the first two lines the linear combination of atomic orbitals (LCAO) coefficients (real and imaginary parts) for each orbital on each atom are listed.</p>
<p>Because the eigenvalues are sorted according to their distance to the target value, we restore an ascending order for plotting using the Linux command line </p><pre class="fragment">cat energies_armchair_hex8.dat |sort -g &gt; energies_armchair_hex8_sorted.dat
</pre><p>Open the file "energies.pdf" to see the resulting energy levels around zero energy.</p>
<p>The charge density of an eigenstate can be displayed using </p><pre class="fragment">$QNANO_DIR/bin/QNANO2ps -positions positions_armchair_hex8.dat -displayEV EV0_armchair_hex8.dat EV1_armchair_hex8.dat -outfile EV0_and_1_armchair_hex8.ps
</pre><p> Similarly to generating a postscript of a structure, we have to supply the position file. Additionally, we specify with "displayEV" the eigenvector files. If more than one eigenvector file is provided, the charge densities are added (For degenerate states, every linear combination is also an eigenstates. The sum of the charge densities is, however, independent of which linear combination is used).</p>
<p>To check that the same result is also obtained with iterative methods, go to a new directory and execute: </p><pre class="fragment">$QNANO_DIR/examples/graphene/03_tightbinding_monolayer_slepc/run_example.sh
</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
