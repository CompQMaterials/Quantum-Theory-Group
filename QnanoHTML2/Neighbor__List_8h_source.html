<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QNANO: /home/moritz/QNANO_PRODUCTION/qnano_new/include/structure/Neighbor_List.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QNANO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_7e3ff1d6f27e8b4304f60f1eae24698f.html">structure</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Neighbor_List.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef QNANO_NEW_NEIGHBOR_LIST_DEFINED_H</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define QNANO_NEW_NEIGHBOR_LIST_DEFINED_H</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;structure/Neighbor.h&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;tightbinding/TB_Parameter_List.h&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;structure/Atoms_in_Boxes.h&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;structure/Atom_List.h&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;structure/Neighborhood_Criterion_Lattice.h&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;structure/Periodic_Vecs.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="classNeighbor__List.html">   12</a></span>&#160;<span class="keyword">class </span><a class="code" href="classNeighbor__List.html">Neighbor_List</a>: <span class="keyword">public</span> <a class="code" href="classList__Class.html">List_Class</a>&lt;std::vector&lt;Neighbor&gt; &gt; {</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#a5403912e43b4f61035ea224fa5b59b53">setup</a>(<a class="code" href="classParameter__Map.html">Parameter_Map</a> &amp;param_map, <span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#a5403912e43b4f61035ea224fa5b59b53">setup</a>(<a class="code" href="classParameter__Map.html">Parameter_Map</a> &amp;param_map);</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#a579ced4f43d50788f83c794cc28cbed9">add</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classNeighborhood__Criterion.html">Neighborhood_Criterion</a> &amp;criterion,  <span class="keywordtype">double</span> boxwidth=-1.);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#a7ad07006f1f7e5edb22d96bc6fbf26f6">add_shifted</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classNeighborhood__Criterion.html">Neighborhood_Criterion</a> &amp;criterion, <span class="keyword">const</span> <a class="code" href="classVec3d.html">Vec3d</a> &amp;shift, <span class="keywordtype">double</span> boxwidth=-1.);</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#ad3678aa2744995febe2c7db26fac682e">calculate</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classNeighborhood__Criterion.html">Neighborhood_Criterion</a> &amp;criterion, <span class="keyword">const</span> std::vector&lt;Vec3d&gt; &amp; periodic_vec=std::vector&lt;Vec3d&gt;(), <span class="keywordtype">double</span> boxwidth=-1.);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#ad3678aa2744995febe2c7db26fac682e">calculate</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classLattice.html">Lattice</a> &amp;lat, <span class="keyword">const</span> std::vector&lt;Vec3d&gt; &amp; periodic_vec=std::vector&lt;Vec3d&gt;(), <span class="keywordtype">double</span> tolerance=0.20){</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classNeighborhood__Criterion__Lattice.html">Neighborhood_Criterion_Lattice</a> criterion(lat, tolerance);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="classNeighbor__List.html#ad3678aa2744995febe2c7db26fac682e">calculate</a>(atlist, criterion, periodic_vec, criterion.upper_bound_radius());</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  }</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  </div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classNeighbor__List.html#a9c1874192818a93d4d2339db3d5010bc">calculate_unrelaxed</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classLattice.html">Lattice</a> &amp;lat, <span class="keywordtype">double</span> tolerance=0.2);</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">void</span> setup_unrelaxed_from_relaxed(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp; atlist, <span class="keyword">const</span> <a class="code" href="classNeighbor__List.html">Neighbor_List</a> &amp; neilist_relaxed, <span class="keyword">const</span> <a class="code" href="classTB__Parameter__List.html">TB_Parameter_List</a> &amp;parlist);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//  bool calcualte_unrelaxed_single(const Atom_List &amp;atlist, size_t index1, size_t index2, size_t nindex, const Lattice &amp;lat, double tolerance=0.2, const Vec3d &amp;shift=Vec3d());</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classNeighbor__List.html#ad3f9072f1db32c12ec1dfba0bff24706">calcualte_unrelaxed_single</a>(<span class="keyword">const</span> <a class="code" href="classNeighbor__List.html">Neighbor_List</a> &amp;other, <span class="keywordtype">size_t</span> index, <span class="keywordtype">size_t</span> n, <span class="keyword">const</span> <a class="code" href="classLattice.html">Lattice</a> &amp;lat, <span class="keywordtype">double</span> tolerance=0.2, <span class="keyword">const</span> <a class="code" href="classVec3d.html">Vec3d</a> &amp;shift=<a class="code" href="classVec3d.html">Vec3d</a>());</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">size_t</span> get_max_neighbors_per_atom()<span class="keyword">const</span>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">//read from file</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">void</span> read(<span class="keyword">const</span> std::string &amp;filename, <span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">//print neighbors file</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">void</span> print(<span class="keyword">const</span> std::string &amp;filename)<span class="keyword">const</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">//print neighbors file with bond vectors &#39;D&#39;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">void</span> print_withD(<span class="keyword">const</span> std::string &amp;filename)<span class="keyword">const</span>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">//Basic consistency check: if A is a neighbor of B, B has to be a neighbor of A</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">void</span> check_consistency()<span class="keyword">const</span>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">//Constructors:</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classNeighbor__List.html">Neighbor_List</a>(){}</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="classNeighbor__List.html">Neighbor_List</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classNeighborhood__Criterion.html">Neighborhood_Criterion</a> &amp;criterion, <span class="keyword">const</span> std::vector&lt;Vec3d&gt; &amp;periodic_vec=std::vector&lt;Vec3d&gt;(), <span class="keywordtype">double</span> boxwidth=-1.){</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classNeighbor__List.html#ad3678aa2744995febe2c7db26fac682e">calculate</a>(atlist, criterion, periodic_vec, boxwidth);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classNeighbor__List.html">Neighbor_List</a>(<span class="keyword">const</span> <a class="code" href="classAtom__List.html">Atom_List</a> &amp;atlist, <span class="keyword">const</span> <a class="code" href="classLattice.html">Lattice</a> &amp;lat, <span class="keyword">const</span> std::vector&lt;Vec3d&gt; &amp;periodic_vec=std::vector&lt;Vec3d&gt;(), <span class="keywordtype">double</span> tolerance=0.2){</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classNeighbor__List.html#ad3678aa2744995febe2c7db26fac682e">calculate</a>(atlist, lat, periodic_vec, tolerance);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;};</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classParameter__Map_html"><div class="ttname"><a href="classParameter__Map.html">Parameter_Map</a></div><div class="ttdef"><b>Definition:</b> Parameter_Map.h:11</div></div>
<div class="ttc" id="classVec3d_html"><div class="ttname"><a href="classVec3d.html">Vec3d</a></div><div class="ttdoc">Class to store positions and to handle operations on 3d vectors. </div><div class="ttdef"><b>Definition:</b> Vec3d.h:9</div></div>
<div class="ttc" id="classNeighbor__List_html_a579ced4f43d50788f83c794cc28cbed9"><div class="ttname"><a href="classNeighbor__List.html#a579ced4f43d50788f83c794cc28cbed9">Neighbor_List::add</a></div><div class="ttdeci">void add(const Atom_List &amp;atlist, const Neighborhood_Criterion &amp;criterion, double boxwidth=-1.)</div><div class="ttdoc">calculate neighbors from Atom_List according to the specified Neighborhood_Criterion, then add them to the existing neighbors </div><div class="ttdef"><b>Definition:</b> Neighbor_List.cc:21</div></div>
<div class="ttc" id="classAtom__List_html"><div class="ttname"><a href="classAtom__List.html">Atom_List</a></div><div class="ttdef"><b>Definition:</b> Atom_List.h:9</div></div>
<div class="ttc" id="classList__Class_html"><div class="ttname"><a href="classList__Class.html">List_Class</a></div><div class="ttdef"><b>Definition:</b> List_Class.h:8</div></div>
<div class="ttc" id="classNeighbor__List_html"><div class="ttname"><a href="classNeighbor__List.html">Neighbor_List</a></div><div class="ttdef"><b>Definition:</b> Neighbor_List.h:12</div></div>
<div class="ttc" id="classTB__Parameter__List_html"><div class="ttname"><a href="classTB__Parameter__List.html">TB_Parameter_List</a></div><div class="ttdef"><b>Definition:</b> TB_Parameter_List.h:8</div></div>
<div class="ttc" id="classNeighborhood__Criterion__Lattice_html"><div class="ttname"><a href="classNeighborhood__Criterion__Lattice.html">Neighborhood_Criterion_Lattice</a></div><div class="ttdef"><b>Definition:</b> Neighborhood_Criterion_Lattice.h:7</div></div>
<div class="ttc" id="classNeighbor__List_html_a7ad07006f1f7e5edb22d96bc6fbf26f6"><div class="ttname"><a href="classNeighbor__List.html#a7ad07006f1f7e5edb22d96bc6fbf26f6">Neighbor_List::add_shifted</a></div><div class="ttdeci">void add_shifted(const Atom_List &amp;atlist, const Neighborhood_Criterion &amp;criterion, const Vec3d &amp;shift, double boxwidth=-1.)</div><div class="ttdoc">Same as &amp;#39;add&amp;#39; but shift the atom positions before checking if the Neighborhood_Criterion is fulfilled...</div><div class="ttdef"><b>Definition:</b> Neighbor_List.cc:25</div></div>
<div class="ttc" id="classNeighborhood__Criterion_html"><div class="ttname"><a href="classNeighborhood__Criterion.html">Neighborhood_Criterion</a></div><div class="ttdef"><b>Definition:</b> Neighborhood_Criterion.h:6</div></div>
<div class="ttc" id="classNeighbor__List_html_a9c1874192818a93d4d2339db3d5010bc"><div class="ttname"><a href="classNeighbor__List.html#a9c1874192818a93d4d2339db3d5010bc">Neighbor_List::calculate_unrelaxed</a></div><div class="ttdeci">void calculate_unrelaxed(const Atom_List &amp;atlist, const Lattice &amp;lat, double tolerance=0.2)</div><div class="ttdoc">Same as &amp;#39;calculate&amp;#39;, but set the bond vector &amp;#39;D&amp;#39; of each &amp;#39;Neighbor&amp;#39; to one matching a neighbor in an ...</div><div class="ttdef"><b>Definition:</b> Neighbor_List.cc:120</div></div>
<div class="ttc" id="classNeighbor__List_html_a5403912e43b4f61035ea224fa5b59b53"><div class="ttname"><a href="classNeighbor__List.html#a5403912e43b4f61035ea224fa5b59b53">Neighbor_List::setup</a></div><div class="ttdeci">void setup(Parameter_Map &amp;param_map, const Atom_List &amp;atlist)</div><div class="ttdoc">setup from command line parameters. Typically, an Atom_List has to be set up anyway, so use if it possible </div><div class="ttdef"><b>Definition:</b> Neighbor_List.cc:4</div></div>
<div class="ttc" id="classLattice_html"><div class="ttname"><a href="classLattice.html">Lattice</a></div><div class="ttdef"><b>Definition:</b> Lattice.h:36</div></div>
<div class="ttc" id="classNeighbor__List_html_ad3678aa2744995febe2c7db26fac682e"><div class="ttname"><a href="classNeighbor__List.html#ad3678aa2744995febe2c7db26fac682e">Neighbor_List::calculate</a></div><div class="ttdeci">void calculate(const Atom_List &amp;atlist, const Neighborhood_Criterion &amp;criterion, const std::vector&lt; Vec3d &gt; &amp;periodic_vec=std::vector&lt; Vec3d &gt;(), double boxwidth=-1.)</div><div class="ttdoc">Clear existing data and &amp;#39;add&amp;#39;. </div><div class="ttdef"><b>Definition:</b> Neighbor_List.cc:59</div></div>
<div class="ttc" id="classNeighbor__List_html_ad3f9072f1db32c12ec1dfba0bff24706"><div class="ttname"><a href="classNeighbor__List.html#ad3f9072f1db32c12ec1dfba0bff24706">Neighbor_List::calcualte_unrelaxed_single</a></div><div class="ttdeci">bool calcualte_unrelaxed_single(const Neighbor_List &amp;other, size_t index, size_t n, const Lattice &amp;lat, double tolerance=0.2, const Vec3d &amp;shift=Vec3d())</div><div class="ttdoc">If there is more than one material, there is more than one equilibrium lattice. Thus, we have to go through all atoms individually to get the correct equilibirum distance vectors. Returns false if neighbor is not found. </div><div class="ttdef"><b>Definition:</b> Neighbor_List.cc:105</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
