<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>QNANO: Example: Graphene in external potential</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QNANO
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">QNANO Documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example: Graphene in external potential </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="graphene_potential"></a>
Graphene in external potential</h1>
<p>Directory: "examples/graphene/05_potential:"</p>
<p>This examples shows how to add local potentials V(R_i) to tight-binding calculations. The potentials are prepared before the actual calculation and stored in a potential file. This file contains a real number per line corresponding to V(R_i) for each atom i in a sample (we have to use the same position file for generation of the potential and for the diagonalization).</p>
<p>To run the example execute </p><pre class="fragment">$QNANO_DIR/examples/graphene/05_potential/run_example.sh
</pre><p>The first part of the example is again the generation of a bilayer graphene structure </p><pre class="fragment">$QNANO_DIR/bin/generate -materialfile $QNANO_DIR/resources/graphene.dat \
-cut_hexagon_armchair $N -outfile pos_monolayer.dat

$QNANO_DIR/bin/add_positions \
-positions pos_monolayer.dat pos_monolayer.dat  \
-lattice_units_materialfile $QNANO_DIR/resources/graphene.dat \
-shift_LU 0.666667 -0.333333 1  -outfile pos_bilayer.dat
</pre><p>IMPORTANT: Up to this stage the origin of the sample is still the point from which the underlying lattice is generated before the hexagon is cut out. Here, however, we want to center the potential on the center of the sample. The command: </p><pre class="fragment">$QNANO_DIR/bin/center_positions -positions pos_bilayer.dat -outfile pos_bilayer.dat
</pre><p> shifts all atom positions so that the origin is the center of the sample.</p>
<p>Now, after the structure is generated, we generate the potential. Here, we apply a bias between the upper and the lower layer, which amounts to applying a constant potential on the atoms in the upper layer by V=0.3 eV and in the lower layer by -V. We use a linear potential V(r)=a*(r*direction), where direction is a unit vector (normalized internally). Since linear potentials are given in units of eV/nm, we use bash tools to calculate the linear potential strength strz and then generate the potential: </p><pre class="fragment">V=0.3       #potential on upper layer: V, on bottom layer: -V, in eV
strz=$(echo 2*$V/0.335|bc -l)     #in program: units eV/nm 

$QNANO_DIR/bin/linear_potential -positions pos_bilayer.dat  \
-outfile test_pot.dat -strength $strz -direction 0 0 1
</pre><p>In addition to the bias, we apply a 2d parabolic confinement potential V(r)=strength*(x^2+y^2), where x and y are the coordinates orthogonal to "direction", truncated after a radius of 2.5 nm on both layers and add this to the bias potential: </p><pre class="fragment">parabV=0.075  #strength of the parabolic confinement potential in eV/nm^2
 
$QNANO_DIR/bin/parabolic_potential_2d -positions pos_bilayer.dat  \
-add_to test_pot.dat -outfile test_pot.dat -strength $parabV  \
-direction 0 0 1 -truncate_radius 2.5
</pre><p>To display the potential we just need to add the "potential" option in </p><pre class="fragment">$QNANO_DIR/bin/QNANO2ps -positions pos_bilayer.dat -potential test_pot.dat \
-boxwidthz 0.2 -translatez 0.2 -outfile pot_upper.ps
$QNANO_DIR/bin/QNANO2ps -positions pos_bilayer.dat -potential test_pot.dat \
-boxwidthz 0.2 -translatez -0.2 -outfile pot_lower.ps
</pre><p>Similarly, we also just have to specify the additional "potential" option for the diagonalization: </p><pre class="fragment">$QNANO_DIR/bin/tightbinding_slepc -resources_dir $QNANO_DIR/resources \
-positions pos_bilayer.dat -potential test_pot.dat \
-eigenvalue_filename "energies_bias_conf.dat" \
-eps_target 0.45 -eps_nev 20 -eps_max_it 1000000  \
-EV_filename_pattern "EV*_bias_conf.dat"  -nr_print  1 
</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
